<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>
<body>
	<h1>polluraamat</h1>
	<div class='actions'>
		<button class='add' data-args='add'>add</button>
		<button class='rem' data-args='rem'>rem</button>
		<button class='get' data-args='get'>get</button>
		<button class='set' data-args='set'>set</button>
		<button class='all' data-args='all'>all</button>	
	</div>
	<div class='result'></div>
	<textarea class='resultraw'></textarea>
</body>
<style>
 .resultraw {
	width:100%;
	height:50%;
 }
 
</style>
<script>
	$('body').on('click','.actions button',function(e){		
		$.ajax('/tegevused/'+$(e.target).data().args,{
			type:'GET',
			success:function(res){
				$('.result').html(res)
				$('.resultraw').val(JSON.stringify(res))
				
			},
			error:function(res){
				$('.resultraw').val(JSON.stringify(res))
			}
		})
	})
	$('body').on('click','form .add',function(e){		
		e.stopPropagation()
		e.preventDefault()
		var form=$(e.target).closest('form'),
			data={}
		
		$.each(form.find('input'),function(i,ele){
			ele=$(ele)
			data[ele.attr('id')]=ele.val()
		})
		
		console.log('post data:',data)
		
		$.ajax('/tegevused/add',{
			type:'POST',
			data:data,
			success:function(res){
				$('.result').html(res)
				$('.resultraw').val(JSON.stringify(res))				
			},
			error:function(res){
				$('.resultraw').val(JSON.stringify(res))
			}
		})
		
	})
	$('body').on('click','.autofill',function(e){
		e.stopPropagation()
		e.preventDefault()
		var form=$(e.target).closest('form')
		$.each(form.find('input'),function(i,ele){
			ele.value=new Date().getTime().toString(16).substring(0,2)
		})
	})
	
</script>